# 更新日志

## v1.2.0 (2025-01-16 最新)

### ✨ 新功能

#### 1. Toast 提示优化
- ✅ 导出成功/失败不再使用浏览器弹窗（alert）
- ✅ 使用插件内的Toast方式提示
- ✅ 成功提示：绿色背景，3秒后自动消失
- ✅ 错误提示：红色背景，3秒后自动消失
- ✅ 带滑入动画效果

#### 2. 字段过滤优化
- ✅ "导出到"下拉菜单自动排除当前正在编辑的字段
- ✅ 只显示其他附件字段
- ✅ 避免将图片导出到自己所在的字段

#### 3. 布局优化
- ✅ 导出工具栏整合到编辑器顶栏
- ✅ 所有控制元素在同一行
- ✅ 左侧：返回按钮 + 标题
- ✅ 右侧：导出到下拉菜单 + 导出按钮
- ✅ 更紧凑的设计，更大的画板空间

### 🎨 界面改进

#### 新的编辑器顶栏布局
```
┌────────────────────────────────────────────────────────┐
│ [← 返回预览] 图片编辑器    导出到: [字段▼] [📤 导出] │
├────────────────────────────────────────────────────────┤
│                                                         │
│                  Excalidraw 画板                        │
│                                                         │
└────────────────────────────────────────────────────────┘
```

#### Toast 提示样式
```
┌──────────────────────┐
│ ✅ 导出成功！已追加  │  ← 绿色，居中顶部显示
└──────────────────────┘

┌──────────────────────┐
│ ❌ 导出失败，请重试  │  ← 红色，居中顶部显示
└──────────────────────┘
```

### 🔧 技术改进

#### 字段过滤逻辑
```typescript
// 获取所有附件字段
const fieldMetaList = await table.getFieldMetaListByType(FieldType.Attachment);

// 过滤掉当前字段
const filteredFields = fieldMetaList.filter(
  field => field.id !== currentFieldId
);
```

#### Toast 提示实现
```typescript
// 显示Toast
showToast('✅ 导出成功！已追加到所选字段', 'success');

// 3秒后自动消失
setTimeout(() => {
  setToast(null);
}, 3000);
```

### 📋 使用场景示例

#### 场景：产品标注流程

**字段设置：**
- "产品原图" - 存放原始图片
- "标注图片" - 存放标注后的图片
- "审核图片" - 存放审核标注

**使用流程：**
1. 选中"产品原图"单元格
2. 点击编辑（标题显示"产品原图"）
3. 用红色铅笔标注
4. 下拉菜单自动排除"产品原图"
5. 选择"标注图片"字段
6. 点击导出
7. 看到Toast提示"✅ 导出成功！"
8. 返回预览，选择"标注图片"查看结果

### 💡 改进亮点

#### 1. 更好的用户体验
- ❌ 旧方式：浏览器弹窗遮挡视线，需要点击确认
- ✅ 新方式：Toast提示不打断操作，自动消失

#### 2. 更智能的字段选择
- ❌ 旧方式：可能选到自己所在的字段，导致混淆
- ✅ 新方式：自动排除当前字段，选项更清晰

#### 3. 更紧凑的布局
- ❌ 旧方式：顶栏和导出工具栏分两行，占用空间
- ✅ 新方式：所有控制在一行，画板空间更大

### ⚠️ 注意事项

#### 无其他附件字段时
如果表格中只有一个附件字段（正在编辑的那个）：
- 下拉菜单显示："暂无其他附件字段"
- 导出按钮自动禁用
- 建议先创建目标附件字段

#### Toast 提示时机
- ✅ 导出成功 → 绿色Toast
- ❌ 导出失败 → 红色Toast
- ⚠️ 未选择字段 → 红色Toast
- 💾  导出中 → 按钮显示"导出中..."

---

## v1.1.0 (2025-01-16)

### ✨ 新功能
- 标题改为显示字段名
- 移除文件类型显示
- 画板默认选中红色铅笔工具
- 新增导出工具栏
- 支持选择目标附件字段
- 一键导出标注图片到多维表格

---

## v1.0.0 (2025-01-16)

### ✨ 初始版本
- 附件预览功能
- 图片文件直接预览
- 文件信息显示
- 多附件切换
- Excalidraw图片编辑器集成
- 深色模式支持

---

**所有功能持续优化中！** 🚀

